digraph EnhancedTimeMoE {
    // Graph properties
    rankdir=TB;
    label="Enhanced Time-MoE with Dual Scoring System";
    labelloc=top;
    fontsize=18;
    fontname="Arial Bold";
    
    // Node properties
    node [style=filled, fontname="Arial", fontsize=12];
    
    // Original Time-MoE structure
    subgraph cluster_original {
        label="Original Time-MoE Architecture";
        color=blue;
        style=dashed;
        
        input_orig [label="Time Series Input", fillcolor=lightblue, shape=box];
        embed_orig [label="Input Embedding", fillcolor=lightgreen, shape=box];
        transformer_orig [label="Transformer Blocks\\n(Self-Attention + MoE-FFN)", fillcolor=lightyellow, shape=box];
        output_orig [label="Standard Output", fillcolor=lightblue, shape=box];
        
        input_orig -> embed_orig;
        embed_orig -> transformer_orig;
        transformer_orig -> output_orig;
    }
    
    // Enhancement with dual scoring
    subgraph cluster_enhancement {
        label="Dual Scoring Enhancement";
        color=red;
        style=dashed;
        
        // Dual scoring components
        subgraph cluster_scoring {
            label="Dual Scoring Mechanism";
            color=purple;
            style=filled;
            fillcolor=thistle;
            
            latent_analysis [label="Latent Space Analysis", fillcolor=lightcyan, shape=box];
            error_analysis [label="Error Analysis", fillcolor=lightcoral, shape=box];
            score_fusion [label="Score Fusion\\n(Weighted Combination)", fillcolor=orchid, shape=ellipse];
        }
        
        refinement [label="Prediction Refinement", fillcolor=lightseagreen, shape=box];
        enhanced_output [label="Enhanced Forecast", fillcolor=gold, shape=box];
        
        latent_analysis -> score_fusion;
        error_analysis -> score_fusion;
        score_fusion -> refinement;
        refinement -> enhanced_output;
    }
    
    // Connections between original and enhancement
    transformer_orig -> latent_analysis;
    transformer_orig -> error_analysis;
    output_orig -> error_analysis;
    output_orig -> refinement;
    
    // Legend
    subgraph cluster_legend {
        label="Legend";
        color=black;
        style=solid;
        
        orig_comp [label="Original Component", fillcolor=lightyellow, shape=box];
        enh_comp [label="Enhancement Component", fillcolor=orchid, shape=box];
        io_node [label="Input/Output", fillcolor=lightblue, shape=box];
    }
}